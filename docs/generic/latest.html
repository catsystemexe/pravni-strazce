<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <title>Právní strážce – GENERIC run (unknown)</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body {
            font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
            margin: 2rem;
            line-height: 1.5;
            background: #0f172a;
            color: #e5e7eb;
        }
        pre {
            white-space: pre-wrap;
            word-wrap: break-word;
            background: #020617;
            padding: 1.5rem;
            border-radius: 0.75rem;
            border: 1px solid #1f2937;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }
        h1 {
            font-size: 1.5rem;
            margin-bottom: 1rem;
        }
        .meta {
            font-size: 0.85rem;
            color: #9ca3af;
            margin-bottom: 0.5rem;
        }
    </style>
</head>
<body>
    <h1>Právní strážce – GENERIC run</h1>
    <div class="meta">
      Tento soubor generuje GitHub Action z repozitáře catsystemexe/pravni-strazce.
      (UTC: unknown)
    </div>
    <pre>================================================================================
ODPOVĚĎ CODING AGENTA:

1. Stručné shrnutí (co z projektu chápu)
- Projekt má jasně oddělené vrstvy: `runtime` (pipeline), `engines` (moduly jako core_legal, judikatura, intent), `llm`, `product`, `packs`, `templates`.
- Doménová data jsou verzovaná ve `data/_source/domains/**` (včetně nové domény `traffic_law`), ale zatím nejsou zkompilovaná do runtime formy.
- Intent engine (`engines/intent/*`) očekává „runtime“ JSONy v `data/intents/**`, ale tento adresář v repu neexistuje → runtime klasifikace intentů reálně nemá z čeho číst.
- V `tools` existují skripty pro generování / validaci intentů z domén (`generate_intents_from_domains.py`, `generate_intents_from_yaml.py`, `validate_intents.py`, `validate_data.py`), které mají tvořit chybějící pipeline `_source → data/intents`.
- Doménová pravidla pro jiné enginy (core_legal, domain_rules) jsou částečně řešená v `engines/domain_rules/*.yaml` a v `docs/domain_catalog*.md`, ale nejsou jednoznačně provázaná s intent strukturou.
- Dokumentace (`docs/intent.system.md`, `docs/README_datova_architektura.md`) už popisuje záměr architektury, ale realita repozitáře je napůl cesty (MIX).

---

## 1) DOMÉNY – analýza `data/_source/domains`

### 1.1 Přehled domén (název složky) a jejich struktura

Adresář: `data/_source/domains`

Pro každou doménu uvádím:
- `*.json` v kořeni domény (přímo uvnitř složky),
- `domain.yaml` v kořeni domény,
- podadresář `intents/` se soubory.

#### 1. `school_law`
- JSON v kořeni: NE (žádný soubor vypsaný)
- `domain.yaml`: NE
- `intents/`: NE
- Poznámka: prázdný placeholder.

#### 2. `debt_law`
- JSON v kořeni: NE
- `domain.yaml`: NE
- `intents/`: NE

#### 3. `environmental_law`
- JSON v kořeni: NE
- `domain.yaml`: NE
- `intents/`: NE

#### 4. `property_construction_law`
- JSON v kořeni: NE
- `domain.yaml`: NE
- `intents/`: NE

#### 5. `social_law`
- JSON v kořeni: NE
- `domain.yaml`: NE
- `intents/`: NE

#### 6. `media_ip_law`
- JSON v kořeni: NE
- `domain.yaml`: NE
- `intents/`: NE

#### 7. `constitutional_law`
- JSON v kořeni: NE
- `domain.yaml`: NE
- `intents/`: NE

#### 8. `family_law`
- JSON v kořeni: NE
- `domain.yaml`: NE
- `intents/`: NE

#### 9. `data_digital_law`
- JSON v kořeni: NE
- `domain.yaml`: NE
- `intents/`: NE

#### 10. `labor_law`
- JSON v kořeni: ANO  
  - `labor_law/labor_termination.json`
- `domain.yaml`: NE
- `intents/`: NE (zatím jen jeden soubor přímo v kořeni)

#### 11. `health_law`
- JSON v kořeni: NE
- `domain.yaml`: NE
- `intents/`: NE

#### 12. `tax_law`
- JSON v kořeni: NE
- `domain.yaml`: NE
- `intents/`: NE

#### 13. `administrative_law`
- JSON v kořeni: ANO  
  - `administrative_law/appeal_admin_decision.json`
- `domain.yaml`: NE
- `intents/`: NE

#### 14. `inheritance_law`
- JSON v kořeni: NE
- `domain.yaml`: NE
- `intents/`: NE

#### 15. `criminal_law`
- JSON v kořeni: ANO  
  - `criminal_law/criminal_defense.json`
- `domain.yaml`: NE
- `intents/`: NE

#### 16. `traffic_law`
- JSON v kořeni: NE
- `domain.yaml`: ANO  
  - `traffic_law/domain.yaml`
- Podadresář `intents/`: ANO  
  - `traffic_law/intents/traffic_speed_offense_police_stop.json`
  - `traffic_law/intents/traffic_speed_offense_dispute_measurements.json`
  - `traffic_law/intents/traffic_speed_offense_abroad.json`
  - `traffic_law/intents/traffic_speed_admin_proceeding.json`
  - `traffic_law/intents/traffic_speed_block_fine.json`
  - `traffic_law/intents/traffic_speed_camera_notice.json`
  - `traffic_law/intents/traffic_speed_offense_generic.json`
- Další soubory:
  - `traffic_law/subdomains.yaml`
  - `traffic_law/readme.md`
- → Jediná doména, která víceméně odpovídá „novému plánovanému modelu“.

#### 17. `corporate_law`
- JSON v kořeni: NE
- `domain.yaml`: NE
- `intents/`: NE

#### 18. `civil_law`
- JSON v kořeni: NE
- `domain.yaml`: NE
- `intents/`: NE

#### 19. `consumer_finance_law`
- JSON v kořeni: ANO  
  - `consumer_finance_law/consumer_credit.json`
- `domain.yaml`: NE
- `intents/`: NE

#### 20. `international_law`
- JSON v kořeni: NE
- `domain.yaml`: NE
- `intents/`: NE

### 1.2 Soulad se zamýšleným doménovým modelem

- Z dokumentace (`docs/domain_catalog.md`, `docs/domain_map_traffic_law.md`, `docs/README_datova_architektura.md`) a ze struktury `traffic_law` je zřejmý cílový model:
  - Každá doména má mít alespoň:
    - `domain.yaml` – metadata domény,
    - volitelně `subdomains.yaml`,
    - `intents/` s jednotlivými intent JSON definicemi v jednotném tvaru (založeném na `_source/_template/intent_template.json`).
- Aktuální stav:
  - `traffic_law` tento model v zásadě respektuje → OK (pilotní doména).
  - `labor_law`, `administrative_law`, `criminal_law`, `consumer_finance_law` používají starší model: jeden JSON soubor v kořeni složky, pravděpodobně ve „starší“ struktuře (spíše popis case / scénáře než plnohodnotný intent).
  - Ostatní domény jsou prázdné „placeholdery“ → připravená adresářová struktura, ale žádná data.
- Závěr k doménám:
  - **OK:** existence doménových složek, pilotní implementace `traffic_law`.
  - **MIX:** některé domény mají starší JSON formát místo nového `intents/`.
  - **BROKEN/MISSING:** většině domén chybí `domain.yaml`, `subdomains.yaml` i `intents/` → nelze z nich generovat runtime intenty.

---

## 2) INTENTS – loader a runtime struktura

### 2.1 Jak je nastaven intent loader (`engines/intent/loader.py`)

- Konstanta:
  ```py
  BASE_DIR = os.path.join(&quot;data&quot;, &quot;intents&quot;)
  ```
- Loader:
  - používá `os.walk(BASE_DIR)` → očekává, že runtime intent definice budou umístěné pod:
    - `data/intents/**/*.json`
  - Každý soubor:
    - Načte se jako JSON.
    - Projde `_normalize_raw()`:
      - `id` → `intent_id`, doplnění `keywords` a `negative_keywords` jako prázdné seznamy, odstranění `intent_group`.
      - Whitelist validních polí (podle staršího setu):  
        `intent_id, label_cs, domain, subdomains, description_cs, keywords, negative_keywords, risk_patterns, basic_questions, safety_questions, normative_references, conclusion_skeletons, notes, version`
      - Vše ostatní se zahodí.
    - Vytvoří se instance `IntentDefinition(**normalized)`.
- Problém:
  - `IntentDefinition` v `definition.py` obsahuje i:
    - `intent_group: str = &quot;general&quot;`
    - `examples: List[str] = field(default_factory=list)`
  - `_normalize_raw` naopak explicitně `intent_group` odstraňuje:
    ```py
    if &quot;intent_group&quot; in raw:
        raw.pop(&quot;intent_group&quot;)
    ```
  - To je vnitřně nekonzistentní:
    - API enginu s tím počítá (`intent_group` používá v `_heuristic_classify`), ale normalizér ho nepustí dovnitř.
    - Naštěstí `IntentDefinition` má default `&quot;general&quot;`, takže to engine úplně nerozbije, ale znemožňuje to mít per-intent group z dat.

### 2.2 Odkud se mají brát „runtime“ intent JSONy

- Podle loaderu: z `data/intents/**`.
- V repozitáři v současnosti:
  - `data/intents` neexistuje (ve výpisu struktury není).
  - Existuje ale:
    - `data/_source/_template/intent_template.json` – šablona zdrojových intentů.
    - `data/_source/domains/**` – zdrojové doménové a intent definice (minimálně u `traffic_law`).
- Z toho plyne:
  - Navržený model je:
    - `_source` = editovatelné doménové zdroje (pro právníky / knowledge tým),
    - `data/intents` = zkompilované, normalizované runtime intenty pro enginy.
  - Překladová vrstva má být realizována skripty v `tools` (viz níže).

### 2.3 Vnitřní konzistence domény ↔ intents

- Dnes:
  - Intent engine očekává hotové runtime JSONy v `data/intents`.
  - Zdrojová data jsou v `data/_source/domains`, částečně v novém modelu (`traffic_law`), částečně ve starém (jeden JSON v kořeni).
  - Skripty pro „kompilaci“ existují v `tools`, ale:
    - ve výpisu není vidět výsledek (`data/intents` adresář),
    - není zřejmé, že se spouštějí v CI ani že je popsaný „build step“ v dokumentaci.
- Tedy:
  - **Chybí jasná a zautomatizovaná pipeline `_source → data/intents`**.
  - Datový model není sjednocený (nové domény vs. starý formát JSON).

---

## 3) NÁSTROJE – skripty v `tools` související s doménami a intenty

Bez obsahu skriptů musím vycházet z názvů, testů a kontextu:

### 3.1 `tools/validate_data.py`
- Účel (odhad):
  - Validovat strukturu dat v `data/_source` a případně `data/schema/domains.json`.
  - Kontrola, že domény odpovídají schématu (ID, názvy, struktura `domain.yaml` apod.).
- Vstupy:
  - Soubor `data/schema/domains.json`:
    - Může definovat schéma nebo seznam povolených domén.
  - Soubory pod `data/_source/domains/**`.
- Výstupy:
  - Výpis chyb a varování (stdout), případně návratový kód pro CI.
- Stav:
  - Pravděpodobně „použitelný skeleton“ – testy neukazují selhání a název odpovídá dokumentaci.
  - Přesné kontroly nejsou známé (chybí kód), ale není žádný signál, že je „rozbitý“.

### 3.2 `tools/generate_intents_from_domains.py`
- Účel (podle názvu a struktury):
  - Generovat runtime intent JSONy do `data/intents/**` na základě:
    - domén a subdomén v `data/_source/domains/**`,
    - možná v kombinaci s `data/schema/domains.json`.
- Vstupy:
  - `data/_source/domains/**`
  - Potenciálně šablona `_source/_template/intent_template.json`.
- Výstupy:
  - Soubory v `data/intents/**` – již ve struktuře odpovídající `IntentDefinition` (nebo formátu očekávanému v `_normalize_raw`).
- Stav:
  - Klíčový kus pipeline, ale ve výpisu repa nevidíme vygenerovaný adresář `data/intents`.
  - V testech není žádný explicitní test pro tento skript (test je jen pro `generate_intents_from_yaml.py`).
  - Vysoce pravděpodobně je buď:
    - neúplný skeleton, nebo
    - zastaralý vůči nové struktuře (`_source/domains/traffic_law/intents`).

### 3.3 `tools/generate_intents_from_yaml.py`
- Účel:
  - Podle názvu a existence testu `tests/test_generate_intents_from_yaml.py`:
    - Parsuje YAML soubory (pravděpodobně `domain.yaml` / `subdomains.yaml`) a generuje z nich runtime intents.
- Vstupy:
  - YAML konfigurace (např. definice subdomén, typů případů).
  - Možná `intent_template.json` jako skeleton.
- Výstupy:
  - JSONy pro `data/intents/**`.
- Stav:
  - Má svůj test → minimálně základní funkcionalita by měla být „OK“.
  - Potenciální problém: loader `engines/intent/loader.py` normalizuje data na starší sadu polí; jestli generátor produkuje novější rozšířené pole (např. `examples`), budou při načítání zahozena, pokud se neaktualizuje `_normalize_raw`.

### 3.4 `tools/render_report_to_html.py`
- Účel:
  - Konverze Markdown reportu (např. výsledek nějaké analýzy, `out/last_report.md`) na HTML.
- Vstupy:
  - Soubor (typicky `.md`).
- Výstupy:
  - Soubor `.html` nebo HTML string.
- Stav:
  - Nepřímo souvisí s doménami/intentami spíše jako vizualizační nástroj → nebude blokovat pipeline.
  - Pravděpodobně použitelný.

### 3.5 `tools/apply_policy.py`
- Účel:
  - Aplikovat produktovou / bezpečnostní / risk politiku na data nebo výstupy, patrně podle `product/**` nebo `prompts/policy/**`.
- Vstupy:
  - Konfigurace (např. `product/e_advokat_pro/*`) nebo `prompts/policy/*`.
- Výstupy:
  - Upravené konfigurace nebo kontrolní report.
- Stav:
  - S doménami/intentami souvisí jen nepřímo; zatím spíše skeleton.

### 3.6 `tools/validate_intents.py`
- Účel:
  - Validovat JSONy v `data/intents/**` proti očekávané struktuře:
    - povinná pole `intent_id, label_cs, domain, description_cs, ...`
    - kontrola duplicitních `intent_id`, nesmyslných `domain` atd.
- Vstupy:
  - `data/intents/**.json`
- Výstupy:
  - Chybový report (stdout, exit code pro CI).
- Stav:
  - Bez `data/intents` v repu nemá nad čím běžet – pipeline není kompletní.
  - Samotný skript může být funkční, ale momentálně není využitelný, protože neexistuje cílový adresář s daty.

---

## 4) Vyhodnocení a konkrétní doporučení

### 4.1 Stav (OK / MIX / BROKEN)

**OK**
- Architektura engine ↔ runtime (`runtime/orchestrator`, `engines/*`).
- Intent engine:
  - Lze načítat intenty přes `load_intents()` z `data/intents`.
  - Heuristické skórování nad `keywords/negative_keywords`.
  - Napojení na LLM (fallback při nízké confidence) s robustním odchycením chyb.
- Datová struktura pro `Traffic Law`:
  - `domain.yaml`, `subdomains.yaml`, `intents/*.json`, `readme.md` – velmi dobrý vzor.
- Dokumentace:
  - `docs/intent.system.md`, `docs/README_datova_architektura.md`, `docs/domain_map_traffic_law.md` – popisují cílový směr.

**MIX (částečně hotové / nekonzistentní)**
- Doménový model:
  - `traffic_law` v novém formátu vs. ostatní domény ve starém/žádném formátu.
- Intent datový model:
  - `IntentDefinition` má pole `intent_group`, `examples`, ale `_normalize_raw`:
    - `intent_group` aktivně vyhazuje a `examples` vůbec nepropouští.
- Nástrojová sada:
  - Máme několik generátorů/validatorů (`generate_intents_from_yaml.py`, `generate_intents_from_domains.py`, `validate_intents.py`, `validate_data.py`), ale:
    - není jasně popsáno, co je „oficiální cesta“,
    - není žádný viditelný build výsledek (`data/intents`).
- Domain rules vs. doménové katalogy:
  - `engines/domain_rules/*.yaml` používají domény pojmenované česky (`civil`, `trestni`, `spravni` atd.).
  - `_source/domains` používá anglické názvy (`civil_law`, `criminal_law`, `administrative_law`).
  - Chybí explicitní mapování / sjednocení identifikátorů.

**BROKEN / MISSING**
- Neexistuje adresář `data/intents` s runtime JSONy:
  - Intent engine reálně nemá index, nad kterým by heuristicky klasifikoval.
- Chybí jasně definovaná a zdokumentovaná **kompilační pipeline**:
  - „Jak se z `_source/domains/**` dostanu ke konsistentním `data/intents/**`?“
- Nesoulad `IntentDefinition` vs. `_normalize_raw`:
  - Data pro `intent_group` a `examples` se nezapisují do runtime struktury, i když je engine částečně očekává.

---

## 5) Konkrétní kroky (v pořadí priority)

### 5.1 Krátkodobé – odblokovat práci s intenty (1–2 dny)

1. **Vytvořit minimální `data/intents` runtime s jednou doménou (traffic_law)**
   - Spusťte, opravte nebo dočasně nahraďte generátor tak, aby:
     - z `data/_source/domains/traffic_law/intents/*.json` vznikly téměř stejné soubory v `data/intents/traffic_law/*.json`.
   - Pro začátek stačí:
     - zachovat klíče z `_source` a případně doplnit chybějící (např. `keywords`, `negative_keywords`, `intent_id`, `label_cs`, `domain`).
   - Cíl:
     - mít funkční heuristickou klasifikaci aspoň pro `traffic_law`, aby se dalo testovat end-to-end.

2. **Zarovnat `IntentDefinition` a `_normalize_raw`**
   - Upravit `_normalize_raw` v `engines/intent/loader.py` tak, aby:
     - NIKDY nevyhazoval `intent_group` (naopak ho povolil ve `valid_fields`).
     - Povolil `examples` v `valid_fields`.
   - Přidat drobný komentář:
     - že `examples` se aktuálně v heuristice nevyužívají, ale jsou užitečné pro LLM / dokumentaci.
   - Tím dosáhneme datové konzistence mezi definicí, loaderem a enginem.

3. **Doplnit minimální `keywords` do traffic_law intentů (pokud chybí)**
   - Zkontrolovat `data/_source/domains/traffic_law/intents/*.json`:
     - zda obsahují `keywords` / `negative_keywords`.
   - Pokud ne:
     - doplnit alespoň pár základních klíčových slov (rychlost, radar, bloková pokuta, atd.) – bez toho heuristika nefunguje.
   - To už je obsahová práce, ale zásadně pomůže funkčnosti.

4. **Krátká poznámka do `docs/intent.system.md`: „Jak lokálně spustit intent engine“**
   - 3–5 bodů:
     - „1) Spusť nástroj X pro generování traffic_law do `data/intents`.“
     - „2) Zkontroluj, že `data/intents` obsahuje JSONy.“
     - „3) Spusť test nebo malý skript, který zavolá `engines.intent.engine.run` nad testovacím dotazem.“

### 5.2 Střednědobé – sjednocení datového modelu a pipeline (_source → data/intents)

5. **Jasně definovat „zdrojový formát“ `_source/domains`**
   - Vytvořit (nebo doplnit) stručnou specifikaci v `docs/README_datova_architektura.md`:
     - Jak má vypadat:
       - `domain.yaml` (ID, název, popis, jazyk, vazba na `engines/domain_rules`).
       - `subdomains.yaml` (hierarchie, tagy).
       - `intents/*.json` (pole odpovídající `_source/_template/intent_template.json`).
   - Udělat z `traffic_law` oficiální referenční příklad (obsah odkazovat v dokumentaci).

6. **Vybrat a standardizovat jeden „oficiální“ generátor intentů**
   - Rozhodnout:
     - zda hlavní pipeline bude:
       - `generate_intents_from_domains.py`, nebo
       - `generate_intents_from_yaml.py`, nebo jejich kombinace.
   - Vítězný skript:
     - přizpůsobit tak, aby:
       - vstupem byly `_source/domains/**` (primárně `domain.yaml`, `subdomains.yaml`, `intents/*.json`),
       - výstup šel do `data/intents/{domain}/{intent_id}.json`,
       - výstupní struktura 1:1 odpovídala `IntentDefinition` (vč. `examples`, `intent_group`).
   - Druhý skript:
     - buď odstranit, nebo jasně označit jako „exotický“ / podpůrný nástroj.

7. **Dodat schéma pro runtime intenty a navázat ho na `tools/validate_intents.py`**
   - Vytvořit JSON schema:
     - např. `data/schema/intent.json`, které definuje:
       - povinná pole: `intent_id, label_cs, domain, description_cs, subdomains, keywords, negative_keywords, basic_questions, safety_questions, conclusion_skeletons`.
       - volitelná: `intent_group, examples, notes, version, risk_patterns, normative_references`.
   - Upravit `validate_intents.py`, aby:
     - procházelo `data/intents/**.json`,
     - validovalo proti schématu,
     - vracelo nenulový exit kód při chybě (pro CI).

8. **Migrovat starší domény (`labor_law`, `administrative_law`, `criminal_law`, `consumer_finance_law`) na nový model**
   - Pro každou z těchto domén:
     - Rozdělit kořenový JSON (např. `criminal_defense.json`) na:
       - `domain.yaml` (metadata domény),
       - `intents/*.json` – jeden soubor na intent (např. `criminal_defense_generic.json` atd.), strukturovaný podle šablony.
   - Jakmile budou přemigrovány:
     - zařadit je do generátoru pro `data/intents`.
   - Cílem je dojít k tomu, že všechny domény:
     - mají `domain.yaml` a `intents/`,
     - a staré kořenové JSONy nejsou potřeba.

9. **Sjednotit identifikátory domén napříč systémy**
   - Propojit:
     - `engines/domain_rules/*.yaml` (např. `civil.yaml`, `trestni.yaml`) s `_source/domains/*` (např. `civil_law`, `criminal_law`).
   - Možnosti:
     - vytvořit mapovací tabulku/domain_catalog v `runtime/domain_catalog.py` (pokud tam už není) a/nebo v `data/schema/domains.json`,
     - nebo přejmenovat adresáře v `_source/domains` na jednotný identifikátor (`civil`, `trestni`, atd.) a `domain.yaml` nechť nese jazykové popisky.
   - Aktualizovat dokumentaci (`docs/domain_catalog.md`), aby používala stejná IDs jako runtime.

### 5.3 Dlouhodobé – testy, dokumentace, refaktoringy

10. **Testovací pokrytí celé doménově-intentové pipeline**
    - Přidat integrační test, který:
      - Spustí oficiální generátor intentů (v test režimu do dočasného adresáře).
      - Zvaliduje výsledek přes `validate_intents.py` a JSON schema.
      - Spustí `engines.intent.engine.run` s několika reprezentativními dotazy (včetně traffic_law, labor_law apod.) a ověří:
        - že vrací nenulový confidence,
        - že `domain` i `intent` patří mezi definované hodnoty.

11. **Lepší dokumentace „od právníka ke stroji“**
    - V `docs/intent.system.md` doplnit:
      - jednoduchý diagram:
        - „právník upraví `_source/domains/X/intents/*.json` → spustí se generátor → vzniknou `data/intents` → loader → intent engine heuristika + LLM.“
      - odkaz na `data/_source/_template/intent_template.json` jako oficiální šablonu.
    - Přidat stručné guideline:
      - jak volit `keywords`, `negative_keywords`, `basic_questions`, `safety_questions`.

12. **Refaktoring loaderu a definic intentů**
    - Jakmile budou data stabilní:
      - zvážit odstranění `_normalize_raw` nebo jeho zjednodušení:
        - ideál: generátor už produkuje přesně to, co `IntentDefinition` očekává, takže `_normalize_raw` jen řeší backward compat.
      - případně přidat verzi schématu (`version`, `schema_version`) a podle ní se rozhodovat, jak data normalizovat.

13. **Upravit/odstranit legacy nástroje**
    - Zhodnotit:
      - zda `generate_intents_from_domains.py` není duplicitní vůči `generate_intents_from_yaml.py`.
      - zda `llm/config.py` může být odstraněn (je označen jako deprecated).
    - Minimalizovat počet „paralelních cest“, kterými se mohou intenty generovat, aby se předešlo driftu.

---

## 6) Co není jasné (co by bylo potřeba doplnit)

- Obsah skriptů v `tools/*`:
  - konkrétně `generate_intents_from_domains.py`, `generate_intents_from_yaml.py`, `validate_intents.py`, `validate_data.py`:
    - Jaký přesně očekávají vstup (YAML vs JSON)?
    - Jak přesně strukturovaný je jejich výstup?
- Obsah `_source/_template/intent_template.json`:
  - které klíče jsou považované za „oficiální“ v `_source` vrstvě?
- Struktura a obsah `data/_source/domains/traffic_law/intents/*.json`:
  - zda již odpovídají `IntentDefinition`, nebo jde o bohatší model (např. scénáře, varianty, více příkladů).
- Aktuální podoba `runtime/domain_catalog.py` a `docs/domain_catalog.md`:
  - jak přesně jsou v runtime pojmenované domény a jak se to má mapovat na `_source/domains` a `engines/domain_rules`.

Jakmile budou tyto informace k dispozici, lze:
- přesněji navrhnout transformace v generátorech a
- formalizovat JSON schema pro runtime intenty.
================================================================================
</pre>
</body>
</html>
